<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#C44B2E" />
  <title>Florence 2026 ğŸŒ¸</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    :root {
      --red:      #C44B2E;
      --cream:    #FFF8F0;
      --dark:     #2C1810;
      --muted:    #7A6055;
      --fri:      #E8834A;
      --sat:      #7C3AED;
      --sun:      #0EA05E;
      --hotel:    #C44B2E;
      --ch:       #E91E8C;
      --safe-top: env(safe-area-inset-top,    0px);
      --safe-bot: env(safe-area-inset-bottom, 0px);
    }
    html, body { height: 100dvh; overflow: hidden; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, sans-serif;
      background: var(--cream);
      color: var(--dark);
      display: flex;
      flex-direction: column;
    }

    /* â”€â”€ HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .header {
      background: linear-gradient(135deg, #9C2E1A 0%, #C44B2E 55%, #E07840 100%);
      color: white;
      padding-top: var(--safe-top);
      flex-shrink: 0;
    }
    .header-inner {
      padding: 12px 16px 11px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .header-text h1 { font-size: 19px; font-weight: 800; letter-spacing: -.3px; }
    .header-text p  { font-size: 11px; opacity: .82; margin-top: 1px; }
    .header-badge {
      background: rgba(255,255,255,.2);
      border: 1px solid rgba(255,255,255,.35);
      border-radius: 20px;
      padding: 3px 10px;
      font-size: 11px;
      font-weight: 700;
    }

    /* â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tabs {
      display: flex;
      background: white;
      border-bottom: 1px solid #EDE4DC;
      flex-shrink: 0;
    }
    .tab {
      flex: 1;
      padding: 11px 4px;
      text-align: center;
      font-size: 12px;
      font-weight: 700;
      color: var(--muted);
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: color .2s, border-color .2s;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .tab.active { color: var(--red); border-bottom-color: var(--red); }

    /* â”€â”€ CONTENT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .content { flex: 1; overflow: hidden; display: flex; flex-direction: column; min-height: 0; }
    .pane    { display: none; flex: 1; flex-direction: column; min-height: 0; overflow: hidden; }
    .pane.active { display: flex; }

    /* â”€â”€ MAP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #map { flex: 1; min-height: 0; }
    .map-controls {
      background: white;
      padding: 7px 10px;
      display: flex;
      gap: 6px;
      flex-shrink: 0;
      border-bottom: 1px solid #EDE4DC;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .map-controls::-webkit-scrollbar { display: none; }
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 10px;
      border-radius: 20px;
      border: 1.5px solid;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      white-space: nowrap;
      transition: opacity .2s;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
      flex-shrink: 0;
    }
    .chip input { display: none; }
    .chip.off { opacity: .32; }
    .dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }

    /* â”€â”€ POPUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .leaflet-popup-content-wrapper { border-radius: 14px !important; padding: 4px !important; box-shadow: 0 6px 24px rgba(0,0,0,.20) !important; }
    .leaflet-popup-content { margin: 12px 14px !important; }
    .pw { font-family: -apple-system, sans-serif; min-width: 220px; max-width: 275px; }
    .pw-name { font-weight: 800; font-size: 15px; color: var(--dark); margin-bottom: 5px; }
    .pw-sub  { font-size: 12px; color: var(--ch); font-weight: 700; margin-bottom: 4px; }
    .pw-desc { font-size: 13px; color: #555; line-height: 1.45; margin-bottom: 7px; }
    .pw-tip  { font-size: 12px; color: #777; font-style: italic; line-height: 1.4; margin-bottom: 9px; border-left: 3px solid #EDE4DC; padding-left: 8px; }
    .pw-tags { display: flex; flex-wrap: wrap; gap: 4px; margin-bottom: 10px; }
    .pw-tag  { font-size: 11px; font-weight: 700; padding: 2px 8px; border-radius: 10px; }
    .t-day   { color: white; }
    .t-book  { background: #FFF0E0; color: #C15400; }
    .t-booked{ background: #E8FFE8; color: #1B6B23; }
    .t-opt   { background: #F0E8FF; color: #5400CC; }
    .pw-btns { display: flex; gap: 6px; flex-wrap: wrap; }
    .pw-btn  { padding: 8px 11px; border-radius: 9px; font-size: 12px; font-weight: 700; border: none; cursor: pointer; text-decoration: none; display: inline-flex; align-items: center; gap: 4px; }
    .btn-gm  { background: #4285F4; color: white; }
    .btn-dir { background: #0F9D58; color: white; }

    /* â”€â”€ TOAST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    #toast {
      position: fixed;
      bottom: calc(var(--safe-bot) + 70px);
      left: 50%; transform: translateX(-50%) translateY(20px);
      background: rgba(44,24,16,.88); color: white;
      font-size: 13px; font-weight: 600;
      padding: 9px 16px; border-radius: 20px;
      pointer-events: none; opacity: 0;
      transition: opacity .3s, transform .3s;
      z-index: 9999; white-space: nowrap;
    }
    #toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

    /* â”€â”€ SCROLL CONTAINER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .scroll {
      flex: 1; overflow-y: auto; min-height: 0;
      padding: 13px 13px calc(var(--safe-bot) + 13px);
      -webkit-overflow-scrolling: touch;
      scrollbar-width: thin;
    }
    .scroll::-webkit-scrollbar { width: 3px; }
    .scroll::-webkit-scrollbar-thumb { background: #DDD; border-radius: 2px; }

    /* â”€â”€ SHARED CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .card {
      background: white; border-radius: 14px;
      padding: 14px 16px; margin-bottom: 14px;
      box-shadow: 0 2px 10px rgba(44,24,16,.08);
    }
    .card h3 { font-size: 14px; font-weight: 800; margin-bottom: 10px; }

    /* â”€â”€ ITINERARY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .ov-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
    .ov-item strong { display: block; font-size: 13px; color: var(--dark); }
    .ov-item span   { font-size: 12px; color: var(--muted); }

    .alert-card {
      border-radius: 14px; padding: 12px 14px; margin-bottom: 14px;
      border: 1.5px solid;
    }
    .alert-card.warn  { background: #FFFBF0; border-color: #F5C842; }
    .alert-card.book  { background: #FFF0E0; border-color: #F0CEAD; }
    .alert-card h3 { font-size: 13px; font-weight: 800; margin-bottom: 8px; }
    .alert-card.warn h3 { color: #8B6000; }
    .alert-card.book h3 { color: #B84E00; }
    .alert-item { font-size: 12px; color: var(--dark); padding: 3px 0; display: flex; gap: 6px; }

    .day-section { border-radius: 14px; overflow: hidden; margin-bottom: 16px; box-shadow: 0 2px 10px rgba(44,24,16,.09); }
    .day-header { padding: 13px 16px; color: white; }
    .day-header h2 { font-size: 16px; font-weight: 800; }
    .day-header p  { font-size: 12px; opacity: .85; margin-top: 2px; }
    .day-stats { display: flex; gap: 8px; margin-top: 8px; flex-wrap: wrap; }
    .day-stats span { background: rgba(255,255,255,.2); padding: 3px 9px; border-radius: 10px; font-size: 11px; font-weight: 700; }

    .transit { display: flex; align-items: center; gap: 8px; padding: 7px 16px; background: #F9F7F5; border-bottom: 1px solid #EEE9E4; font-size: 12px; color: #999; }

    .stop { background: white; padding: 13px 16px; border-bottom: 1px solid #F5F0EC; }
    .stop:last-child { border-bottom: none; }
    .stop-time { font-size: 11px; color: #AAA; font-weight: 700; letter-spacing: .3px; margin-bottom: 3px; }
    .stop-name { font-size: 15px; font-weight: 800; color: var(--dark); line-height: 1.2; }
    .stop-desc { font-size: 13px; color: #5A5A5A; margin-top: 5px; line-height: 1.5; white-space: pre-line; }
    .stop-badges { display: flex; flex-wrap: wrap; gap: 5px; margin-top: 8px; }
    .badge { font-size: 11px; font-weight: 700; padding: 3px 8px; border-radius: 10px; }
    .b-walk   { background: #E8F5E9; color: #1B6B23; }
    .b-book   { background: #FFF0E0; color: #B84E00; }
    .b-booked { background: #E8FFE8; color: #1B6B23; }
    .b-opt    { background: #F0E8FF; color: #5400CC; }
    .b-rest   { background: #FFE8EE; color: #AA1042; }
    .b-taxi   { background: #E8F0FF; color: #1A43B5; }
    .b-warn   { background: #FFF4D0; color: #8B5E00; }
    .stop-acts { display: flex; gap: 6px; margin-top: 10px; flex-wrap: wrap; }
    .s-btn { display: inline-flex; align-items: center; gap: 4px; padding: 8px 11px; border-radius: 9px; font-size: 12px; font-weight: 700; text-decoration: none; border: none; cursor: pointer; -webkit-tap-highlight-color: transparent; }

    /* â”€â”€ TICKETS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tkt-card {
      border-radius: 16px; overflow: hidden;
      margin-bottom: 16px;
      box-shadow: 0 3px 14px rgba(44,24,16,.13);
    }
    .tkt-hdr {
      padding: 14px 16px; color: white;
      display: flex; align-items: flex-start; gap: 12px;
    }
    .tkt-emoji { font-size: 30px; line-height: 1; flex-shrink: 0; }

    .tkt-hdr h2 { font-size: 16px; font-weight: 800; line-height: 1.2; }
    .tkt-hdr p  { font-size: 12px; opacity: .85; margin-top: 2px; }
    .tkt-body { background: white; padding: 14px 16px; }

    /* tear line */
    .tkt-tear {
      height: 12px;
      background: linear-gradient(to right, white 0%, white 100%);
      position: relative; overflow: hidden;
    }
    .tkt-tear::before {
      content: '';
      display: block;
      height: 24px;
      background: radial-gradient(circle at 50% 0%, transparent 10px, white 10px);
      background-size: 24px 24px;
      background-position: center top;
      margin-top: -12px;
    }

    .tkt-time-block {
      display: flex; align-items: baseline; gap: 6px;
      margin-bottom: 12px;
    }
    .tkt-time {
      font-size: 30px; font-weight: 900; color: var(--dark);
      letter-spacing: -1px; line-height: 1;
    }
    .tkt-time-label { font-size: 12px; color: var(--muted); font-weight: 600; }

    .tkt-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 12px; }
    .tkt-field strong { display: block; font-size: 11px; font-weight: 700; color: var(--muted); text-transform: uppercase; letter-spacing: .4px; }
    .tkt-field span { font-size: 13px; font-weight: 700; color: var(--dark); }

    .tkt-refs {
      background: #F5F0EC; border-radius: 10px;
      padding: 10px 12px; margin-bottom: 12px;
      font-size: 11px; color: var(--muted); font-family: 'Courier New', monospace;
      line-height: 1.8;
    }
    .tkt-refs strong { color: var(--dark); font-weight: 700; }

    .tkt-includes {
      background: #EEF4FF; border: 1px solid #C0D4F5; border-radius: 10px;
      padding: 10px 12px; margin-bottom: 12px;
    }
    .tkt-includes h4 { font-size: 12px; font-weight: 800; color: #1A3A7A; margin-bottom: 6px; }
    .tkt-inc-item { font-size: 12px; color: #1A3A7A; padding: 2px 0; display: flex; gap: 6px; }

    .tkt-warn {
      background: #FFFBEC; border: 1px solid #F5D87A; border-radius: 10px;
      padding: 10px 12px; margin-bottom: 12px;
    }
    .tkt-warn h4 { font-size: 12px; font-weight: 800; color: #8B5E00; margin-bottom: 5px; }
    .tkt-warn-item { font-size: 12px; color: #7A4E00; padding: 2px 0; display: flex; gap: 6px; line-height: 1.4; }

    .tkt-alert {
      background: #FFF0E0; border: 1.5px solid #F5B87A; border-radius: 10px;
      padding: 10px 12px; margin-bottom: 12px;
      font-size: 12px; font-weight: 700; color: #B84E00;
    }

    .tkt-acts { display: flex; gap: 6px; flex-wrap: wrap; }
    .tkt-btn { display: inline-flex; align-items: center; gap: 4px; padding: 8px 12px; border-radius: 9px; font-size: 12px; font-weight: 700; text-decoration: none; border: none; cursor: pointer; }

    /* â”€â”€ TIPS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .tips-section { background: white; border-radius: 14px; padding: 14px 16px; margin-bottom: 14px; box-shadow: 0 2px 10px rgba(44,24,16,.08); }
    .tips-section h3 { font-size: 15px; font-weight: 800; color: var(--dark); margin-bottom: 12px; }
    .tip-row { display: flex; gap: 10px; padding: 9px 0; border-bottom: 1px solid #F5F0EC; align-items: flex-start; }
    .tip-row:last-child { border-bottom: none; padding-bottom: 0; }
    .tip-icon { font-size: 20px; flex-shrink: 0; line-height: 1; margin-top: 1px; }
    .tip-body strong { display: block; font-size: 13px; font-weight: 700; color: var(--dark); }
    .tip-body span { font-size: 12px; color: var(--muted); line-height: 1.45; }
    .phrase-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
    .phrase strong { display: block; font-size: 12px; color: var(--dark); }
    .phrase em { display: block; font-style: italic; font-size: 11px; color: var(--muted); }

    /* â”€â”€ LEAFLET MARKER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .cm { display: flex; align-items: center; justify-content: center; border-radius: 50%; border: 2.5px solid white; box-shadow: 0 2px 8px rgba(0,0,0,.3); }

    /* â”€â”€ RESPONSIVE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (min-width: 390px) { .header-text h1 { font-size: 21px; } .tab { font-size: 13px; } }
    @media (min-width: 768px) { .header-text h1 { font-size: 26px; } .tab { font-size: 15px; padding: 14px; } }
  </style>
</head>
<body>

<div class="header">
  <div class="header-inner">
    <div class="header-text">
      <h1>ğŸŒ¸ Florence 2026</h1>
      <p>Hotel Berchielli Â· Thu 19 â€“ Sun 22 Feb</p>
    </div>
    <div class="header-badge">ğŸ‡®ğŸ‡¹ 4 days</div>
  </div>
</div>

<div class="tabs">
  <div class="tab active" id="tab-map-btn"  onclick="switchTab('map')">ğŸ—ºï¸ Map</div>
  <div class="tab"        id="tab-itin-btn" onclick="switchTab('itin')">ğŸ“… Itinerary</div>
  <div class="tab"        id="tab-tkt-btn"  onclick="switchTab('tkt')">ğŸ« Tickets</div>
  <div class="tab"        id="tab-tips-btn" onclick="switchTab('tips')">ğŸ’¡ Tips</div>
</div>

<div class="content">
  <div class="pane active" id="pane-map">
    <div class="map-controls" id="mapControls"></div>
    <div id="map"></div>
  </div>
  <div class="pane" id="pane-itin"><div class="scroll" id="itinerary"></div></div>
  <div class="pane" id="pane-tkt"><div class="scroll" id="tickets"></div></div>
  <div class="pane" id="pane-tips"><div class="scroll" id="tips"></div></div>
</div>

<div id="toast"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CONSTANTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const C = { hotel:'#C44B2E', fri:'#E8834A', sat:'#7C3AED', sun:'#0EA05E', ch:'#E91E8C' };
const HOTEL = { lat:43.76945, lng:11.25193, name:'Hotel Berchielli',
  desc:'Your home base â€” right on the Arno, steps from Ponte Vecchio.',
  mapsUrl:'https://maps.google.com/?q=Hotel+Berchielli+Lungarno+Acciaiuoli+Florence' };

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TICKET DATA  (from PDFs)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const TICKETS = [
  {
    id:'accademia', icon:'ğŸ—¿', color:'#1A3A7A',
    name:'Galleria dell\'Accademia',
    subtitle:'Statue of David Â· Saturday 21 Feb 2026',
    time:'08:45', timeRange:'08:45 â€“ 09:00',
    people:['Luis Nunez'],
    order:'22111728', amount:'â‚¬24.00',
    refs:[{l:'Order / ID',v:'22111728 Â· ID 67'},{l:'Customer',v:'Luis Nunez Clavijo'}],
    includes:null,
    warnings:[
      'ğŸ’ Small bags only â€” max 40Ã—30Ã—18cm. No cloakroom.',
      'ğŸ” Metal detector security check at entry.',
      'ğŸ“± Show ticket on phone screen at access control.',
    ],
    alert:'âš ï¸ Only 1 Accademia ticket in files (Luis). Verify Carla\'s ticket!',
    mapsUrl:'https://maps.google.com/?q=Galleria+Accademia+Via+Ricasoli+Florence',
    lat:43.77672, lng:11.25815,
  },
  {
    id:'giotto', icon:'ğŸ””', color:'#7C3000',
    name:'Giotto Pass Ã— 2 Adults',
    subtitle:'Campanile Â· Baptistery Â· Museo Â· Santa Reparata',
    time:'11:15', timeRange:'Campanile entry 11:15 SHARP',
    people:['Luis Nunez', 'Carla Montero'],
    order:'87-YUSCLCE', amount:'â‚¬40.00 (â‚¬20 Ã— 2)',
    refs:[
      {l:'Confirmation', v:'SPUVTARA79KK'},
      {l:'Booking #1',   v:'87-EKIK4JM'},
      {l:'Booking #2',   v:'87-CGYRRZO'},
      {l:'Ticket #1',    v:'12-2421-63-1927280297'},
      {l:'Ticket #2',    v:'12-2421-63-1927280298'},
    ],
    includes:[
      'ğŸ”” Campanile (Bell Tower) â€” 414 steps, no lift',
      'â›ª Battistero (Baptistery) â€” enter from North door',
      'ğŸ›ï¸ Museo dell\'Opera del Duomo â€” Piazza del Duomo 9',
      'â›ª Santa Reparata â€” via Campanile door of Cathedral',
    ],
    warnings:[
      'â›” NO BACKPACKS â€” mandatory. Leave at hotel or Deposito Bagagli at Duomo complex.',
      'â° Campanile slot at 11:15 is FIXED and cannot be changed. Arrive 10 min early.',
      'ğŸ”§ Baptistery note: vault mosaics currently under restoration (not visible).',
      'ğŸ“… Pass valid Sat 21 â€“ Mon 23 Feb (3 days) â€” use Baptistery/Museo any day.',
    ],
    alert:null,
    mapsUrl:'https://maps.google.com/?q=Campanile+di+Giotto+Piazza+del+Duomo+Florence',
    lat:43.77299, lng:11.25581,
  },
  {
    id:'uffizi', icon:'ğŸ–¼ï¸', color:'#1B5E20',
    name:'Le Gallerie degli Uffizi Ã— 2',
    subtitle:'Botticelli Â· da Vinci Â· Raphael Â· Michelangelo',
    time:'09:00', timeRange:'Entry from 09:00 Â· Sunday 22 Feb 2026',
    people:['Luis Nunez', 'Carla Montero'],
    order:'S22WTAG2', amount:'â‚¬58.00 (â‚¬29 Ã— 2)',
    refs:[{l:'PNR',v:'S22WTAG2'},{l:'Issued',v:'19-02-2026'}],
    includes:null,
    warnings:[
      'ğŸ“± Show ticket on phone or print â€” present at access control.',
      'ğŸ“· Photography without flash is allowed inside.',
    ],
    alert:null,
    mapsUrl:'https://maps.google.com/?q=Uffizi+Galleries+Piazzale+degli+Uffizi+Florence',
    lat:43.76787, lng:11.25535,
  },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAP LOCATIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const LOCS = [
  // FRIDAY
  { id:'smn-farm',       name:'Farmaceutica di S.M. Novella',         icon:'ğŸŒ¿', day:'fri', lat:43.77445, lng:11.24969,
    desc:'The world\'s oldest pharmacy (1221) inside a frescoed chapel. Divine perfumes and potions.',
    tip:'Monâ€“Sat 9amâ€“8pm, Sun 10amâ€“6pm.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Officina+Profumo+Farmaceutica+Santa+Maria+Novella+Florence' },

  { id:'basilica-novella', name:'Basilica di Santa Maria Novella',    icon:'â›ª', day:'fri', lat:43.77452, lng:11.24901,
    desc:'Gothic marble masterpiece. Masaccio\'s Trinity fresco inside changed the history of painting.',
    tip:'Entry â‚¬7.50. Monâ€“Thu, Sat 9amâ€“7pm; Fri & Sun 1â€“7pm.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Basilica+Santa+Maria+Novella+Florence' },

  { id:'mercato-centrale', name:'Mercato Centrale',                    icon:'ğŸ›’', day:'fri', lat:43.77616, lng:11.25381,
    desc:'Iconic iron-and-glass market. Ground floor: produce, meats, lampredotto. Upstairs food court from 10am.',
    tip:'Try lampredotto (tripe sandwich) â€” the most authentic Florentine street food.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Mercato+Centrale+Florence' },

  { id:'duomo',           name:'Duomo â€“ Santa Maria del Fiore',        icon:'ğŸ›ï¸', day:'fri', lat:43.77308, lng:11.25600,
    desc:'Brunelleschi\'s dome dominates Florence\'s skyline. The exterior + free interior is stunning. Campanile climb is Saturday (ticketed).',
    tip:'Cathedral free Monâ€“Sat 10:15â€“15:45, closed Sundays. Dress code: no bare shoulders/legs. Your Giotto Pass (Campanile) is Saturday at 11:15.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Cattedrale+di+Santa+Maria+del+Fiore+Florence' },

  { id:'baptistery',     name:'Baptistery of San Giovanni',             icon:'ğŸšª', day:'sat', lat:43.77336, lng:11.25516,
    desc:'Ghiberti\'s "Gates of Paradise" bronze doors are one of the supreme works of the Renaissance. On your Giotto Pass.',
    tip:'Included in Giotto Pass. Enter from North door. Note: vault mosaics currently under restoration.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Battistero+di+San+Giovanni+Florence' },

  { id:'campanile',      name:'Giotto\'s Campanile âœ… BOOKED',          icon:'ğŸ””', day:'sat', lat:43.77299, lng:11.25581,
    desc:'BOOKED Saturday 21 Feb at 11:15. 414 steps to the best panoramic view in Florence â€” you can see the dome itself from here.',
    tip:'â›” NO BACKPACKS. Arrive 10 min before your 11:15 slot. 414 steps, no lift. Your Giotto Pass covers this + Baptistery + Museo.',
    book:true, opt:false, mapsUrl:'https://maps.google.com/?q=Campanile+di+Giotto+Florence' },

  { id:'signoria',       name:'Piazza della Signoria & Neptune',        icon:'ğŸŸï¸', day:'fri', lat:43.76979, lng:11.25592,
    desc:'Florence\'s grand civic square â€” free open-air museum. Neptune Fountain, David copy, Perseus by Cellini, Palazzo Vecchio.',
    tip:'Completely free. The Loggia dei Lanzi sculptures are world-class.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Piazza+della+Signoria+Florence' },

  { id:'palazzo-vecchio', name:'Palazzo Vecchio',                      icon:'ğŸ°', day:'fri', lat:43.76956, lng:11.25598,
    desc:'Medieval fortress-palace, Florence\'s town hall since 1299. Frescoed halls inside.',
    tip:'Entry â‚¬12.50. Courtyard peek is free.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Palazzo+Vecchio+Florence' },

  { id:'vinaio',         name:'All\'Antico Vinaio',                     icon:'ğŸ¥ª', day:'fri', lat:43.76862, lng:11.25548,
    desc:'Florence\'s most famous sandwich shop â€” giant schiacciata with Tuscan meats and cheeses.',
    tip:'Via dei Neri 74/76. Arrive before noon. Worth every minute of the queue!',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=All+Antico+Vinaio+Via+dei+Neri+Florence' },

  { id:'uffizi',         name:'Uffizi Galleries âœ… BOOKED',              icon:'ğŸ–¼ï¸', day:'sun', lat:43.76787, lng:11.25535,
    desc:'BOOKED Sunday 22 Feb at 09:00. Botticelli\'s Birth of Venus & Primavera, da Vinci, Raphael, Michelangelo.',
    tip:'PNR: S22WTAG2. Show ticket on phone. Opens 9am. Allow 2â€“2.5 hours.',
    book:true, opt:false, mapsUrl:'https://maps.google.com/?q=Uffizi+Galleries+Florence' },

  { id:'ponte-vecchio',  name:'Ponte Vecchio',                          icon:'ğŸŒ‰', day:'fri', lat:43.76803, lng:11.25312,
    desc:'Medieval bridge lined with jewellers since the 13th century. Magical Arno views at golden hour.',
    tip:'Free to cross. Walk to the middle for the best views both up and downstream.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Ponte+Vecchio+Florence' },

  { id:'zaza',           name:'Trattoria ZÃ  ZÃ  âœ…',                     icon:'ğŸ½ï¸', day:'fri', lat:43.77659, lng:11.25431,
    desc:'BOOKED Friday at 19:30. Classic Florentine trattoria. Ribollita, pappardelle al cinghiale, bistecca alla Fiorentina.',
    tip:'âœ… Reservation 19:30. ~15 min walk from hotel.',
    book:true, opt:false, mapsUrl:'https://maps.google.com/?q=Trattoria+Za+Za+Piazza+del+Mercato+Centrale+Florence' },

  // SATURDAY
  { id:'accademia',      name:'Galleria dell\'Accademia âœ… BOOKED',      icon:'ğŸ—¿', day:'sat', lat:43.77672, lng:11.25815,
    desc:'BOOKED Saturday 21 Feb at 08:45. Michelangelo\'s David â€” 5.17m of Carrara marble perfection.',
    tip:'Order 22111728. Show on phone. Bags max 40Ã—30Ã—18cm only. Metal detector at entry.',
    book:true, opt:false, mapsUrl:'https://maps.google.com/?q=Galleria+Accademia+Via+Ricasoli+Florence' },

  { id:'duomo-museo',    name:'Museo dell\'Opera del Duomo',             icon:'ğŸ›ï¸', day:'sat', lat:43.77350, lng:11.25630,
    desc:'Houses Michelangelo\'s PietÃ  Bandini and Ghiberti\'s original Gates of Paradise panels. On your Giotto Pass.',
    tip:'Piazza del Duomo 9. Included in Giotto Pass. Can be visited any day 21â€“23 Feb.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Museo+Opera+del+Duomo+Florence' },

  { id:'pitti',          name:'Palazzo Pitti',                           icon:'ğŸ‘‘', day:'sat', lat:43.76511, lng:11.24976,
    desc:'Enormous Medici palace with the Palatine Gallery â€” Raphael, Titian, Rubens. Boboli Gardens behind.',
    tip:'Boboli only â‚¬8, Pitti + Boboli combo â‚¬16. Saturdays can be busy â€” go for gardens if tired from morning.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Palazzo+Pitti+Florence' },

  { id:'boboli',         name:'Boboli Gardens',                          icon:'ğŸŒ¿', day:'sat', lat:43.76295, lng:11.25087,
    desc:'Renaissance gardens behind Pitti â€” fountains, grottos, cypress alleys, city views.',
    tip:'â‚¬8 entry (or â‚¬16 Pitti combo). A peaceful escape after a busy morning of museums.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Boboli+Gardens+Florence' },

  { id:'santo-spirito',  name:'Piazza Santo Spirito',                    icon:'â›ª', day:'sat', lat:43.76541, lng:11.24806,
    desc:'The most laid-back square in Florence. Local cafes, osterie, and a Sunday antique market.',
    tip:'Sunday market 9amâ€“7pm (seasonal). The basilica has a Michelangelo crucifix.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Piazza+Santo+Spirito+Florence' },

  { id:'babae',          name:'Babae â€“ Buchette del Vino',               icon:'ğŸ·', day:'sat', lat:43.76690, lng:11.24985,
    desc:'Order wine through a 400-year-old stone hatch in the wall â€” a uniquely Florentine tradition.',
    tip:'Via Santa Monaca 7r. Open afternoons. Get a Chianti through the little door!',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Babae+Via+Santa+Monaca+Florence' },

  { id:'brancacci',      name:'Cappella Brancacci',                      icon:'ğŸ¨', day:'sat', lat:43.76594, lng:11.24551,
    desc:'"Sistine Chapel of the Early Renaissance" â€” Masaccio\'s frescoes that changed Western art.',
    tip:'Book ahead (â‚¬10, only 30 visitors at a time). Mon, Wedâ€“Sat 10amâ€“5pm, Sun 1â€“5pm.',
    book:true, opt:true, mapsUrl:'https://maps.google.com/?q=Cappella+Brancacci+Florence' },

  { id:'piazzale',       name:'Piazzale Michelangelo',                   icon:'ğŸŒ…', day:'sat', lat:43.76281, lng:11.26520,
    desc:'The definitive panoramic view of Florence. February sunset ~17:45 â€” arrive 30 min early for a good spot.',
    tip:'Walk up from Oltrarno ~20 min (steep), or Bus 13. Completely free.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Piazzale+Michelangelo+Florence' },

  { id:'san-miniato',   name:'Basilica di San Miniato al Monte',         icon:'ğŸ•', day:'sat', lat:43.75742, lng:11.26572,
    desc:'Beautiful Romanesque church above Piazzale Michelangelo. Monks sing Vespers at 5:30pm.',
    tip:'Free entry. 5 min uphill from Piazzale. Vespers (5:30pm) is hauntingly beautiful.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Basilica+San+Miniato+al+Monte+Florence' },

  { id:'reggia',         name:'La Reggia degli Etruschi âœ…',              icon:'ğŸ½ï¸', day:'sat', lat:43.8022, lng:11.2982,
    desc:'BOOKED Saturday at 19:30. Dinner in the hills of Fiesole with panoramic views over all of Florence.',
    tip:'Taxi from Piazzale Michelangelo ~15 min (~â‚¬20â€“25). Return taxi ~â‚¬25â€“30.',
    book:true, opt:false, mapsUrl:'https://maps.app.goo.gl/pfFNhVKDHgZfW9hn7' },

  // SUNDAY
  { id:'piazza-rep',     name:'Piazza della Repubblica',                  icon:'â˜•', day:'sun', lat:43.77160, lng:11.25385,
    desc:'Grand 19th-century square. Historic CaffÃ¨ Gilli (since 1733), vintage carousel.',
    tip:'A coffee at Gilli is a treat. Stand at the bar for the authentic (and cheaper) experience.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Piazza+della+Repubblica+Florence' },

  { id:'vivoli',         name:'Vivoli â€“ Gelato dal 1929',                 icon:'ğŸ¦', day:'sun', lat:43.76938, lng:11.25973,
    desc:'Florence\'s oldest gelateria. No cones â€” only cups! The perfect farewell affogato.',
    tip:'Via dell\'Isola delle Stinche 7. Closed Mon. Try rice, coffee, or chocolate.',
    book:false, opt:false, mapsUrl:'https://maps.google.com/?q=Vivoli+Gelateria+Florence' },

  { id:'odeon',          name:'Odeon Cinema',                             icon:'ğŸ¬', day:'sun', lat:43.77280, lng:11.25150,
    desc:'1920s Art Deco cinema inside a historic palazzo. Screens original-version English films.',
    tip:'Worth a look for the extraordinary interior architecture.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Odeon+Cinema+Florence' },

  // FOOD
  { id:'vinaio2',        name:'L\'Girone de\' Ghiotti',                   icon:'ğŸ¥ª', day:'fri', lat:43.77350, lng:11.25720,
    desc:'Casual Florentine sandwiches and crostini â€” great local lunch near the Duomo.',
    tip:'Simple and authentic. Great crostini misti.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Il+Girone+dei+Ghiotti+Florence' },
  { id:'retrobottega',   name:'Retrobottega',                              icon:'ğŸ¥ª', day:'fri', lat:43.76998, lng:11.25295,
    desc:'Creative modern Tuscan sandwiches near the hotel.',
    tip:'Small spot, great for a quick creative lunch.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Retrobottega+Florence' },
  { id:'panino-chianti', name:'Il Panino del Chianti',                     icon:'ğŸ¥ª', day:'fri', lat:43.76900, lng:11.25420,
    desc:'Excellent Chianti-region sandwiches near the Uffizi area.',
    tip:'Casual and quick. Pair with a glass of Chianti.',
    book:false, opt:true, mapsUrl:'https://maps.google.com/?q=Il+Panino+del+Chianti+Florence' },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   CHRISTINA'S PICKS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const CHRIS = [
  { id:'c01', name:'La Gelatiera',          lat:43.76892, lng:11.25100, type:'Ice Cream',         rating:'4.8â­', desc:'Top-rated artisanal gelato.',                                                  url:'https://maps.google.com/?q=La+Gelatiera+Florence' },
  { id:'c02', name:'Braceria All\'11',       lat:43.77230, lng:11.24900, type:'Restaurant',         rating:'4.8â­', desc:'Excellent meat restaurant.',                                                   url:'https://maps.google.com/?q=Braceria+All+11+Florence' },
  { id:'c03', name:'Osteria Belguardo',      lat:43.76800, lng:11.24600, type:'Italian',            rating:'4.5â­', desc:'Lovely Oltrarno osteria â€” warm, local, great value.',                          url:'https://maps.google.com/?q=Osteria+Belguardo+Florence' },
  { id:'c04', name:'il Pacchero â€“ pizza',    lat:43.77556, lng:11.26100, type:'Pizza â‚¬20â€“30',       rating:'4.6â­', desc:'Great pizza slightly off the tourist track.',                                  url:'https://maps.google.com/?q=il+Pacchero+Florence' },
  { id:'c05', name:'Le Barrique',            lat:43.77100, lng:11.25300, type:'Italian Wine Bar',   rating:'4.2â­', desc:'Cosy wine bar with small plates and great atmosphere.',                        url:'https://maps.google.com/?q=Le+Barrique+Florence' },
  { id:'c06', name:'Trattoria Giovanni',     lat:43.77440, lng:11.25460, type:'Restaurant â‚¬20â€“30',  rating:'4.8â­', desc:'One of Florence\'s most beloved trattorias.',                                  url:'https://maps.google.com/?q=Trattoria+Giovanni+Florence' },
  { id:'c07', name:'Madova Gloves',          lat:43.76800, lng:11.24950, type:'Leather Goods',      rating:'4.7â­', desc:'Famous leather glove maker since 1919 â€” crafted to your hand size.',            url:'https://maps.google.com/?q=Madova+Florence' },
  { id:'c08', name:'Trattoria Mario',        lat:43.77600, lng:11.25430, type:'Tuscan â‚¬20â€“30',      rating:'4.6â­', desc:'Legendary workers\' trattoria near Mercato Centrale. Communal tables!',          url:'https://maps.google.com/?q=Trattoria+Mario+Florence' },
  { id:'c09', name:'Da\' Vinattieri',         lat:43.76840, lng:11.25700, type:'Lampredotto â‚¬1â€“10',  rating:'4.7â­', desc:'Tiny spot for lampredotto â€” authentic Florence street food.',                    url:'https://maps.google.com/?q=Da+Vinattieri+Florence' },
  { id:'c10', name:'Trattoria Dall\'Oste',   lat:43.77380, lng:11.25660, type:'Steak Â£Â£',           rating:'4.7â­', desc:'Famous for bistecca alla Fiorentina.',                                         url:'https://maps.google.com/?q=Trattoria+Dall+Oste+Florence' },
  { id:'c11', name:'La Giostra',             lat:43.76980, lng:11.26100, type:'Italian Â£Â£Â£',        rating:'4.3â­', desc:'Charming restaurant run by a Medici family descendant.',                        url:'https://maps.google.com/?q=La+Giostra+Florence' },
  { id:'c12', name:'Trattoria La Casalinga', lat:43.76550, lng:11.24700, type:'Tuscan â‚¬20â€“30',      rating:'4.5â­', desc:'Old-school Oltrarno trattoria â€” great value, deeply authentic.',                url:'https://maps.google.com/?q=Trattoria+La+Casalinga+Florence' },
  { id:'c13', name:'Gustapizza',             lat:43.76610, lng:11.24680, type:'Pizza â‚¬10â€“20',       rating:'4.5â­', desc:'Beloved Oltrarno pizza â€” queue outside the tiny spot.',                        url:'https://maps.google.com/?q=Gustapizza+Florence' },
  { id:'c14', name:'Gelateria dei Neri',     lat:43.76800, lng:11.25650, type:'Ice Cream Â£Â£',       rating:'4.7â­', desc:'Excellent gelato near Santa Croce.',                                           url:'https://maps.google.com/?q=Gelateria+dei+Neri+Florence' },
  { id:'c15', name:'La Strega Nocciola',     lat:43.76820, lng:11.25230, type:'Ice Cream Â£Â£',       rating:'4.7â­', desc:'Artisanal gelato near Ponte Vecchio. The hazelnut is exceptional.',             url:'https://maps.google.com/?q=La+Strega+Nocciola+Ponte+Vecchio+Florence' },
  { id:'c16', name:'Gelateria La Carraia',   lat:43.76760, lng:11.25000, type:'Ice Cream â‚¬',        rating:'4.7â­', desc:'Beloved gelateria near Ponte alla Carraia â€” incredible value.',                  url:'https://maps.google.com/?q=Gelateria+La+Carraia+Florence' },
  { id:'c17', name:'La CitÃ©',               lat:43.76600, lng:11.24650, type:'Bistro/Books',        rating:'4.5â­', desc:'Charming bookshop bistro in Oltrarno.',                                        url:'https://maps.google.com/?q=La+Cite+Florence' },
  { id:'c18', name:'Rooster Cafe',           lat:43.77600, lng:11.25000, type:'Brunch â‚¬10â€“20',      rating:'4.8â­', desc:'Top-rated brunch spot. Perfect for a relaxed morning.',                        url:'https://maps.google.com/?q=Rooster+Cafe+Firenze' },
  { id:'c19', name:'Trattoria I\'raddi',     lat:43.76580, lng:11.24780, type:'Restaurant â‚¬20â€“30',  rating:'4.5â­', desc:'Local favourite in Oltrarno â€” homestyle Tuscan cooking.',                       url:'https://maps.google.com/?q=Trattoria+Iraddi+Florence' },
  { id:'c20', name:'La MÃ©nagÃ¨re',            lat:43.77140, lng:11.25280, type:'Restaurant/Bar Â£Â£',  rating:'4.2â­', desc:'Beautiful restaurant and lifestyle concept store.',                             url:'https://maps.google.com/?q=La+Menagere+Florence' },
  { id:'c21', name:'La Fettunta',            lat:43.76610, lng:11.24750, type:'Tuscan â‚¬10â€“30',      rating:'4.7â­', desc:'Excellent Tuscan food in Oltrarno.',                                           url:'https://maps.google.com/?q=La+Fettunta+Florence' },
  { id:'c22', name:'Osteria Santo Spirito',  lat:43.76541, lng:11.24770, type:'Restaurant â‚¬20â€“30',  rating:'4.4â­', desc:'On Piazza Santo Spirito. Great outdoor seating.',                              url:'https://maps.google.com/?q=Osteria+Santo+Spirito+Florence' },
  { id:'c23', name:'La Terrazza Rooftop',    lat:43.76820, lng:11.25260, type:'Bar/Views',          rating:'3.6â­', desc:'Hotel Continentale rooftop bar â€” views over Ponte Vecchio.',                  url:'https://maps.google.com/?q=La+Terrazza+Hotel+Continentale+Florence' },
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ITINERARY
   Key anchors from tickets:
   SAT: Accademia 08:45 Â· Campanile 11:15 (FIXED)
   SUN: Uffizi 09:00 (BOOKED)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const ITIN = [
  { day:'thu', title:'Thursday â€“ Arrival Night', color:'#888',
    subtitle:'Late arrival Â· Just check in & rest', stats:[],
    stops:[
      { time:'Late night', icon:'âœˆï¸', name:'Arrive in Florence',
        desc:'Head straight to Hotel Berchielli (Lungarno Acciaiuoli 14). Ponte Vecchio is 2 minutes on foot â€” magical at night if you have energy.',
        badges:[] },
      { time:'Night', icon:'ğŸ¨', name:'Hotel Berchielli â€“ Check In',
        desc:'Front desk is 24h. Settle in and rest â€” tomorrow starts early.',
        badges:[] },
    ]},

  { day:'fri', title:'Friday â€“ The Heart of Florence', color:C.fri,
    subtitle:'Full day Â· ~7 km walking Â· Dinner booked 19:30',
    stats:['~7 km', '~85 min walking', 'Dinner 19:30'],
    stops:[
      { time:'8:00', icon:'â˜•', name:'Breakfast',
        desc:'Italian colazione â€” espresso + cornetto at a local bar. Stand at the counter; it\'s authentic and cheaper.',
        badges:[] },
      { tr:'ğŸš¶ From hotel â†’ 12 min Â· 1.0 km' },
      { time:'9:00â€“10:00', icon:'ğŸŒ¿', name:'Farmaceutica di Santa Maria Novella',
        desc:'The world\'s oldest pharmacy (1221) in a stunning frescoed chapel. Perfumes, soaps, herbal remedies. One of the most atmospheric shops in Florence.',
        badges:['â° Open 9am'], loc:'smn-farm' },
      { tr:'ğŸš¶ 2 min Â· 0.15 km' },
      { time:'10:00â€“10:30', icon:'â›ª', name:'Basilica di Santa Maria Novella',
        desc:'Gothic marble faÃ§ade â€” one of Florence\'s best exteriors. Masaccio\'s Trinity fresco inside (â‚¬7.50) changed the history of perspective in painting.',
        badges:['ğŸŸï¸ â‚¬7.50 entry'], loc:'basilica-novella' },
      { tr:'ğŸš¶ 8 min Â· 0.6 km' },
      { time:'10:30â€“11:30', icon:'ğŸ›’', name:'Mercato Centrale',
        desc:'Browse the stunning covered market. Ground floor: fresh produce, aged pecorino, cured meats. Upstairs food court. Try a lampredotto sandwich â€” the most Florentine bite possible.',
        badges:['ğŸ†“ Free entry'], loc:'mercato-centrale' },
      { tr:'ğŸš¶ 12 min Â· 0.9 km' },
      { time:'11:30â€“13:00', icon:'ğŸ›ï¸', name:'Duomo â€“ Exterior & Free Interior',
        desc:'Marvel at Brunelleschi\'s dome and the extraordinary marble faÃ§ade. The Cathedral interior is free (Monâ€“Sat 10:15â€“15:45) â€” enter from the main door. Dress code: no bare shoulders or legs.\n\nNote: your Campanile climb (Giotto Pass) is Saturday at 11:15 â€” so just enjoy the exterior and interior today.',
        badges:['ğŸ†“ Exterior + interior free', 'ğŸ‘— Dress code required', 'ğŸ”” Campanile = Saturday'], loc:'duomo' },
      { tr:'ğŸš¶ 10 min Â· 0.75 km' },
      { time:'13:00â€“14:00', icon:'ğŸ¥ª', name:'Lunch â€“ All\'Antico Vinaio',
        desc:'Florence\'s most famous sandwich shop. Giant schiacciata stuffed with finocchiona, truffle cream, roasted peppers, pecorino. One of the best things you\'ll eat all trip.',
        badges:['ğŸ¥ª Via dei Neri 74/76', 'ğŸ’¶ ~â‚¬8â€“10', 'â° Go before noon!'], loc:'vinaio' },
      { tr:'ğŸš¶ 5 min Â· 0.35 km' },
      { time:'14:00â€“15:30', icon:'ğŸŸï¸', name:'Piazza della Signoria & Loggia dei Lanzi',
        desc:'Florence\'s free open-air sculpture museum. Neptune Fountain, the David copy, Perseus by Cellini, Rape of the Sabine Women. Walk through the Loggia â€” it\'s entirely free and magnificent.',
        badges:['ğŸ†“ All free'], loc:'signoria' },
      { tr:'ğŸš¶ 8 min Â· 0.5 km' },
      { time:'15:30â€“16:30', icon:'ğŸŒ‰', name:'Ponte Vecchio & Arno Walk',
        desc:'Stroll the medieval bridge lined with jewellers, then walk the Lungarno (river embankment) back toward the hotel in the afternoon light.',
        badges:['ğŸ†“ Free'], loc:'ponte-vecchio' },
      { tr:'ğŸš¶ 5 min back to hotel' },
      { time:'16:30â€“18:30', icon:'ğŸ¨', name:'Rest & Freshen Up',
        desc:'You\'ve walked ~7 km! Rest at the hotel. Optional: walk 10 min to Vivoli for an affogato (espresso poured over gelato â€” your coffee helado!).',
        badges:[] },
      { tr:'ğŸš¶ 15 min from hotel Â· 1.1 km' },
      { time:'19:30', icon:'ğŸ·', name:'Dinner â€“ Trattoria ZÃ  ZÃ  âœ… BOOKED',
        desc:'Your reservation! Classic Florentine trattoria near Mercato Centrale. Must-tries: ribollita (Tuscan bread soup), pappardelle al cinghiale (wild boar pasta), bistecca alla Fiorentina. Pair with Chianti Classico Riserva.',
        badges:['âœ… Reservation 19:30', 'ğŸ½ï¸ Classic Florentine'], loc:'zaza' },
    ]},

  { day:'sat', title:'Saturday â€“ Accademia Â· Campanile Â· Oltrarno Â· Fiesole', color:C.sat,
    subtitle:'Hard anchors: Accademia 08:45 Â· Campanile 11:15 Â· Dinner 19:30',
    stats:['~9 km', 'â›” No backpacks!', 'Dinner in Fiesole'],
    stops:[
      { time:'7:30', icon:'âš ï¸', name:'IMPORTANT: Pack light today',
        desc:'The Campanile (11:15) does NOT allow backpacks. Leave large bags at the hotel. Small purses/sling bags (max 40Ã—30Ã—18cm) are fine. The Accademia also only allows small bags.',
        badges:['â›” NO backpacks for Campanile', 'ğŸ’ Small bags max 40Ã—30Ã—18cm'] },
      { time:'7:45', icon:'â˜•', name:'Quick Breakfast',
        desc:'Quick espresso and cornetto at a bar near the hotel. You need to leave by 8:20.',
        badges:[] },
      { tr:'ğŸš¶ Leave hotel by 8:20 Â· 20 min walk Â· 1.5 km' },
      { time:'08:45 âœ…', icon:'ğŸ—¿', name:'Galleria dell\'Accademia â€“ BOOKED',
        desc:'Michelangelo\'s David (1501â€“1504) â€” 5.17m of Carrara marble perfection. The hall of Prisoners (Michelangelo\'s unfinished figures) leading to David is profoundly moving. Allow 1.5 hrs.',
        badges:['âœ… BOOKED 08:45', 'ğŸ“± Order 22111728 Â· show on phone', 'âš ï¸ Carla: verify your ticket!'], loc:'accademia' },
      { tr:'ğŸš¶ 15 min to Duomo complex Â· 1.1 km' },
      { time:'10:15', icon:'ğŸ›ï¸', name:'Walk to Duomo Complex â€” Drop Bags',
        desc:'Walk south-west to the Duomo. If you have any bags beyond a small pouch, leave them at the Deposito Bagagli (luggage storage) inside the Duomo complex before your Campanile slot.',
        badges:['â›” Deposito Bagagli mandatory for zaini/backpacks'] },
      { time:'11:00', icon:'â±ï¸', name:'Arrive at Campanile â€” be early!',
        desc:'Be at the Campanile entrance (base of the bell tower, south side of Duomo) by 11:00. Your slot is 11:15 and is non-changeable. Show Giotto Pass QR codes on both phones.',
        badges:['âš ï¸ Slot is 11:15 sharp, non-modifiable', 'ğŸ“± Have both Giotto Pass QR codes ready'] },
      { time:'11:15 âœ…', icon:'ğŸ””', name:'Campanile di Giotto â€“ BOOKED',
        desc:'Your 11:15 slot! 414 steps to the top (no lift). You can see the dome from here â€” arguably the best view of it in the city. Allow 45â€“60 min. The views over Florence are extraordinary.',
        badges:['âœ… Giotto Pass Â· 11:15 slot', 'ğŸš¶ 414 steps Â· no lift', 'â± Allow ~1 hour'], loc:'campanile' },
      { tr:'ğŸš¶ 1 min walk' },
      { time:'12:15â€“12:45', icon:'ğŸšª', name:'Battistero (Baptistery)',
        desc:'Enter from the North door (on your Giotto Pass). Ghiberti\'s golden "Gates of Paradise" bronze doors are magnificent. Note: vault mosaics are under restoration and not visible inside.',
        badges:['âœ… Giotto Pass included', 'â›ª North door entry', 'ğŸ”§ Vault mosaics under restoration'], loc:'baptistery' },
      { time:'12:45â€“13:00', icon:'ğŸ›ï¸', name:'Duomo Interior (free) or Museo dell\'Opera',
        desc:'Option A: Enter the Cathedral for free via the Santa Reparata entrance (Campanile door, south side) â€” see the Gothic interior and the underground Santa Reparata excavations.\nOption B: Head to Museo dell\'Opera del Duomo (Piazza del Duomo 9) â€” it\'s on your Giotto Pass and houses Michelangelo\'s PietÃ  Bandini and original Gates of Paradise panels.',
        badges:['ğŸ†“ Cathedral free (dress code)', 'âœ… Museo on Giotto Pass'], loc:'duomo-museo' },
      { tr:'ğŸš¶ 10 min to lunch Â· 0.75 km' },
      { time:'13:00â€“14:00', icon:'ğŸ¥ª', name:'Lunch near Piazza Signoria',
        desc:'Head to All\'Antico Vinaio again (it\'s that good!) or:\nâ€¢ Il Panino del Chianti â€” near Uffizi\nâ€¢ Retrobottega â€” creative Tuscan sandwiches\nâ€¢ Da\' Vinattieri (Christina\'s pick) â€” lampredotto on the go',
        badges:['ğŸ’¡ Several great options near Signoria'] },
      { tr:'ğŸš¶ 8 min across Ponte Vecchio Â· 0.6 km' },
      { time:'14:00â€“15:30', icon:'ğŸŒ‰', name:'Cross to Oltrarno',
        desc:'Cross Ponte Vecchio to the south bank. The Oltrarno is quieter and more local â€” artisan workshops, neighbourhood bars, real Florence. Wander Via Maggio and the backstreets.',
        badges:[], loc:'ponte-vecchio' },
      { tr:'ğŸš¶ 10 min Â· 0.7 km' },
      { time:'14:30â€“15:45', icon:'ğŸ‘‘', name:'Palazzo Pitti / Boboli Gardens (optional)',
        desc:'After a big morning, a light option:\nâ€¢ Boboli Gardens only (â‚¬8) â€” fountains, grottos, city views. Peaceful and beautiful.\nâ€¢ Skip Pitti interior today if museum fatigue is setting in â€” save energy for the sunset walk.',
        badges:['âš¡ Optional', 'ğŸŒ¿ Boboli â‚¬8 Â· Pitti+Boboli â‚¬16'], loc:'pitti' },
      { tr:'ğŸš¶ 5 min Â· 0.35 km' },
      { time:'15:45â€“16:15', icon:'â›ª', name:'Piazza Santo Spirito',
        desc:'The most relaxed square in Florence. Aperitivo at one of the bars. Check if the Sunday antique market is running (9amâ€“7pm). The basilica has a Michelangelo crucifix in the sacristy.',
        badges:['ğŸ› Sunday market (check locally)', 'ğŸ†“ Free'], loc:'santo-spirito' },
      { tr:'ğŸš¶ 5 min Â· 0.35 km' },
      { time:'16:15â€“16:45', icon:'ğŸ·', name:'Babae â€“ Buchette del Vino',
        desc:'Order wine through a 400-year-old stone hatch (buchetta del vino) embedded in the palazzo wall. A uniquely Florentine experience revived by Babae. Get a Chianti through the little door!',
        badges:['ğŸ· Via Santa Monaca 7r', 'ğŸ’¶ ~â‚¬4â€“6/glass'], loc:'babae' },
      { tr:'ğŸš¶ 20 min uphill (or Bus 13) Â· 1.4 km' },
      { time:'17:10â€“18:10', icon:'ğŸŒ…', name:'Piazzale Michelangelo â€“ Sunset',
        desc:'The most iconic view in Florence. February sunset is around 17:45 â€” arrive by 17:15 for a spot. The entire skyline â€” Duomo, Campanile, Palazzo Vecchio â€” turns golden. Unforgettable.',
        badges:['ğŸŒ‡ Sunset ~17:45 in February', 'ğŸ†“ Free', 'ğŸšŒ Bus 13 if you don\'t want to walk up'], loc:'piazzale' },
      { tr:'ğŸš• Taxi from Piazzale Michelangelo Â· ~15â€“20 min Â· ~â‚¬20â€“25' },
      { time:'19:30 âœ…', icon:'ğŸ·', name:'Dinner â€“ La Reggia degli Etruschi BOOKED',
        desc:'Your Saturday dinner in the hills of Fiesole! Panoramic views over Florence from above. Tuscan cuisine in an extraordinary hilltop setting. This will be a lasting memory.',
        badges:['âœ… Booked 19:30', 'ğŸ“ Fiesole hills', 'ğŸŒƒ Views over Florence'], loc:'reggia' },
      { time:'After dinner', icon:'ğŸš•', name:'Taxi Back to Hotel',
        desc:'~20â€“25 min back down into Florence (~â‚¬25â€“30 from Fiesole). Enjoy the night views as you descend.',
        badges:['ğŸš• ~25 min Â· ~â‚¬25â€“30'] },
    ]},

  { day:'sun', title:'Sunday â€“ Uffizi & Last Morning', color:C.sun,
    subtitle:'Hard anchor: Uffizi 09:00 Â· Leave airport ~15:00 âœˆï¸',
    stats:['~4 km', 'Uffizi 09:00 BOOKED', 'Airport 15:00'],
    stops:[
      { time:'8:00', icon:'â˜•', name:'Last Italian Breakfast',
        desc:'Savour your final espresso al bar. Stand at the counter, sip slowly, watch Florentines begin their Sunday.',
        badges:[] },
      { tr:'ğŸš¶ 12 min from hotel Â· 0.9 km' },
      { time:'09:00 âœ…', icon:'ğŸ–¼ï¸', name:'Le Gallerie degli Uffizi â€“ BOOKED',
        desc:'Botticelli\'s Birth of Venus & Primavera â€” the most recognisable paintings in the world. Also: da Vinci\'s Annunciation, Raphael\'s portraits, Michelangelo\'s Doni Tondo. Take your time, this is extraordinary.',
        badges:['âœ… BOOKED 09:00', 'ğŸ“± PNR: S22WTAG2 Â· show both tickets', 'â± Allow 2â€“2.5 hrs', 'ğŸ“· Photos OK, no flash'], loc:'uffizi' },
      { tr:'ğŸš¶ 8 min Â· 0.6 km' },
      { time:'11:30â€“12:00', icon:'â˜•', name:'CaffÃ¨ Gilli â€“ Piazza della Repubblica',
        desc:'Historic cafÃ© since 1733 on Florence\'s grandest square. A proper coffee and pastry as a treat on your last morning. The vintage carousel makes for a beautiful final photo.',
        badges:['â˜• Historic cafÃ© since 1733', 'ğŸ  Vintage carousel on the square'], loc:'piazza-rep' },
      { tr:'ğŸš¶ 10 min Â· 0.75 km' },
      { time:'12:00â€“12:30', icon:'ğŸ¦', name:'Vivoli â€“ Farewell Affogato',
        desc:'Florence\'s oldest gelateria (since 1929). End your trip with an affogato â€” a shot of espresso poured over vanilla gelato. No cones here, only cups. The perfect farewell to Florence.',
        badges:['ğŸ¦ Since 1929', 'â˜• Order the affogato!', 'ğŸ’¶ â‚¬2â€“4', 'âŒ Closed Mondays â€” but today is Sunday âœ“'], loc:'vivoli' },
      { tr:'ğŸš¶ 10 min back to hotel' },
      { time:'13:00', icon:'ğŸ¨', name:'Hotel Checkout & Pack',
        desc:'Collect luggage, check out, settle any extras. Book your taxi to the airport in advance (itTaxi or Uber).',
        badges:[] },
      { time:'15:00', icon:'âœˆï¸', name:'Leave for Florence Airport âœˆï¸',
        desc:'Taxi to Aeroporto Amerigo Vespucci (Peretola) â€” ~20â€“25 min from the hotel. Arrivederci, Firenze! ğŸŒ¸',
        badges:['ğŸš• ~20â€“25 min', 'âœˆï¸ Aeroporto di Firenze Peretola'] },
    ]},
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TAB SWITCHING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function switchTab(tab) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.pane').forEach(p => p.classList.remove('active'));
  document.getElementById(`tab-${tab}-btn`).classList.add('active');
  document.getElementById(`pane-${tab}`).classList.add('active');
  if (tab === 'map') setTimeout(() => map.invalidateSize(), 100);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let toastT;
function toast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg; el.classList.add('show');
  clearTimeout(toastT);
  toastT = setTimeout(() => el.classList.remove('show'), 2200);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MAP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const map = L.map('map', { center:[43.7700, 11.2530], zoom:14, zoomControl:false });
L.control.zoom({ position:'bottomright' }).addTo(map);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution:'Â© <a href="https://openstreetmap.org">OpenStreetMap</a>', maxZoom:19,
}).addTo(map);

function mkIcon(emoji, bg, sz=34) {
  return L.divIcon({
    html:`<div class="cm" style="width:${sz}px;height:${sz}px;background:${bg};font-size:${Math.round(sz*.44)}px">${emoji}</div>`,
    iconSize:[sz,sz], iconAnchor:[sz/2,sz/2], popupAnchor:[0,-sz/2-2], className:'',
  });
}
function christIcon() {
  return L.divIcon({
    html:`<div class="cm" style="width:27px;height:27px;background:linear-gradient(135deg,#FF6B9D,#C042B0);font-size:12px">â­</div>`,
    iconSize:[27,27], iconAnchor:[13,13], popupAnchor:[0,-15], className:'',
  });
}

function dayName(d) { return {fri:'Friday',sat:'Saturday',sun:'Sunday'}[d]||d; }
function mainPopup(loc) {
  const col = C[loc.day]||'#888';
  const bookedTag = (loc.name.includes('âœ…') || loc.book) ?
    (loc.name.includes('âœ…') ? '<span class="pw-tag t-booked">âœ… Booked</span>' : '<span class="pw-tag t-book">ğŸ“‹ Book ahead</span>') : '';
  return `<div class="pw">
    <div class="pw-name">${loc.icon} ${loc.name}</div>
    <div class="pw-desc">${loc.desc}</div>
    ${loc.tip?`<div class="pw-tip">ğŸ’¡ ${loc.tip}</div>`:''}
    <div class="pw-tags">
      <span class="pw-tag t-day" style="background:${col}">${dayName(loc.day)}</span>
      ${bookedTag}
      ${loc.opt?'<span class="pw-tag t-opt">Optional</span>':''}
    </div>
    <div class="pw-btns">
      <a href="${loc.mapsUrl}" target="_blank" class="pw-btn btn-gm">ğŸ—ºï¸ Open Maps</a>
      <a href="https://www.google.com/maps/dir/?api=1&destination=${loc.lat},${loc.lng}" target="_blank" class="pw-btn btn-dir">ğŸ“ Directions</a>
    </div>
  </div>`;
}
function chrisPopup(r) {
  return `<div class="pw">
    <div class="pw-sub">â­ Christina's Recommendation</div>
    <div class="pw-name">${r.name}</div>
    <div style="font-size:12px;font-weight:700;color:${C.ch};margin-bottom:5px">${r.rating} Â· ${r.type}</div>
    <div class="pw-desc">${r.desc}</div>
    <div class="pw-btns">
      <a href="${r.url}" target="_blank" class="pw-btn btn-gm">ğŸ—ºï¸ Open Maps</a>
      <a href="https://www.google.com/maps/dir/?api=1&destination=${r.lat},${r.lng}" target="_blank" class="pw-btn btn-dir">ğŸ“ Directions</a>
    </div>
  </div>`;
}

// Hotel marker
L.marker([HOTEL.lat, HOTEL.lng], { icon: mkIcon('ğŸ¨', C.hotel, 42) })
  .bindPopup(`<div class="pw"><div class="pw-name">ğŸ¨ ${HOTEL.name}</div><div class="pw-desc">${HOTEL.desc}</div><div class="pw-btns"><a href="${HOTEL.mapsUrl}" target="_blank" class="pw-btn btn-gm">ğŸ—ºï¸ Open Maps</a></div></div>`)
  .addTo(map);

// Main markers
const markerMap = {};
const byDay = { fri:[], sat:[], sun:[] };
LOCS.forEach(loc => {
  const col = C[loc.day]||'#888';
  const m = L.marker([loc.lat, loc.lng], { icon: mkIcon(loc.icon, col) })
    .bindPopup(mainPopup(loc), { maxWidth:300 }).addTo(map);
  markerMap[loc.id] = m;
  if (byDay[loc.day]) byDay[loc.day].push(m);
});

// Christina markers
const chMarkers = [];
CHRIS.forEach(r => {
  const m = L.marker([r.lat, r.lng], { icon: christIcon() })
    .bindPopup(chrisPopup(r), { maxWidth:280 }).addTo(map);
  chMarkers.push(m);
});

// Day routes
const ROUTES = {
  fri:[ [HOTEL.lat,HOTEL.lng],[43.77445,11.24969],[43.77452,11.24901],[43.77616,11.25381],
        [43.77308,11.25600],[43.76862,11.25548],[43.76979,11.25592],
        [43.76803,11.25312],[HOTEL.lat,HOTEL.lng],[43.77659,11.25431] ],
  sat:[ [HOTEL.lat,HOTEL.lng],[43.77672,11.25815],[43.77299,11.25581],[43.77336,11.25516],
        [43.76862,11.25548],[43.76979,11.25592],[43.76803,11.25312],
        [43.76511,11.24976],[43.76541,11.24806],[43.76690,11.24985],
        [43.76281,11.26520],[43.8022,11.2982] ],
  sun:[ [HOTEL.lat,HOTEL.lng],[43.76787,11.25535],[43.77160,11.25385],
        [43.76938,11.25973],[HOTEL.lat,HOTEL.lng] ],
};
const routeLayers = {};
Object.entries(ROUTES).forEach(([d,coords]) => {
  routeLayers[d] = L.polyline(coords, { color:C[d], weight:3, opacity:.65, dashArray:'9,7' }).addTo(map);
});

// Fly-to from itinerary
function flyTo(id) {
  const loc = LOCS.find(l => l.id === id);
  if (!loc) return;
  switchTab('map');
  setTimeout(() => {
    map.flyTo([loc.lat, loc.lng], 17, { duration:1.2 });
    setTimeout(() => markerMap[id]?.openPopup(), 1300);
  }, 150);
  toast(`ğŸ“ ${loc.name.replace(' âœ… BOOKED','').replace(' âœ…','')}`);
}

// Filter chips
const ctrl = document.getElementById('mapControls');
function mkChip(label, col, key, isCh=false) {
  const el = document.createElement('label');
  el.className = 'chip';
  el.style.cssText = `border-color:${col};color:${col};background:${col}15`;
  el.innerHTML = `<input type="checkbox" checked><span class="dot" style="background:${col}"></span>${label}`;
  el.querySelector('input').addEventListener('change', e => {
    const on = e.target.checked;
    el.classList.toggle('off', !on);
    if (isCh) { chMarkers.forEach(m => on ? m.addTo(map) : map.removeLayer(m)); }
    else {
      byDay[key]?.forEach(m => on ? m.addTo(map) : map.removeLayer(m));
      if (routeLayers[key]) on ? routeLayers[key].addTo(map) : map.removeLayer(routeLayers[key]);
    }
  });
  return el;
}
ctrl.appendChild(mkChip('Friday',       C.fri, 'fri'));
ctrl.appendChild(mkChip('Saturday',     C.sat, 'sat'));
ctrl.appendChild(mkChip('Sunday',       C.sun, 'sun'));
ctrl.appendChild(mkChip("â­ Christina's", C.ch,  'ch',  true));

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ITINERARY RENDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const itinEl = document.getElementById('itinerary');

itinEl.innerHTML = `
  <div class="card">
    <h3>ğŸ“Œ Trip at a Glance</h3>
    <div class="ov-grid">
      <div class="ov-item"><strong>ğŸ¨ Hotel</strong><span>Berchielli, Lungarno Acciaiuoli</span></div>
      <div class="ov-item"><strong>ğŸ“… Dates</strong><span>Thu 19 â€“ Sun 22 Feb 2026</span></div>
      <div class="ov-item"><strong>ğŸ· Fri dinner</strong><span>Trattoria ZÃ  ZÃ  Â· 19:30</span></div>
      <div class="ov-item"><strong>ğŸ· Sat dinner</strong><span>La Reggia Etruschi Â· 19:30</span></div>
      <div class="ov-item"><strong>âœˆï¸ Departure</strong><span>Sunday ~15:00</span></div>
      <div class="ov-item"><strong>ğŸš¶ Total walking</strong><span>~18â€“20 km over 3 days</span></div>
    </div>
  </div>
  <div class="alert-card warn">
    <h3>â›” Saturday Warning â€” Read Before You Go!</h3>
    <div class="alert-item">ğŸ’ <span><strong>NO BACKPACKS on Saturday</strong> â€” Campanile strictly prohibits them. Leave at hotel or Deposito Bagagli at the Duomo complex.</span></div>
    <div class="alert-item">â° <span><strong>Campanile slot 11:15 is fixed</strong> and cannot be changed. Arrive at the tower by 11:00.</span></div>
    <div class="alert-item">ğŸ—¿ <span><strong>Leave hotel by 8:20</strong> to reach Accademia for 8:45 entry.</span></div>
    <div class="alert-item">âš ï¸ <span><strong>Accademia: only 1 ticket confirmed for Luis</strong> â€” verify Carla's ticket before Saturday!</span></div>
  </div>
  <div class="alert-card book">
    <h3>âœ… Your Confirmed Bookings</h3>
    <div class="alert-item">ğŸ—¿ <span><strong>Accademia (David)</strong> â€” Sat 21 Feb Â· 08:45 Â· Order 22111728</span></div>
    <div class="alert-item">ğŸ”” <span><strong>Giotto Pass Ã—2</strong> (Campanile + Baptistery + Museo) â€” Sat 21 Feb Â· Campanile 11:15</span></div>
    <div class="alert-item">ğŸ–¼ï¸ <span><strong>Uffizi Ã—2</strong> â€” Sun 22 Feb Â· 09:00 Â· PNR S22WTAG2</span></div>
    <div class="alert-item">ğŸ· <span><strong>Trattoria ZÃ  ZÃ </strong> â€” Fri 20 Feb Â· 19:30</span></div>
    <div class="alert-item">ğŸ· <span><strong>La Reggia degli Etruschi</strong> â€” Sat 21 Feb Â· 19:30 Â· Fiesole</span></div>
  </div>`;

function badgeCls(b) {
  if (b.includes('âœ…') || b.includes('Booked') || b.includes('BOOKED')) return 'b-booked';
  if (b.includes('ğŸ“‹') || b.includes('Book')) return 'b-book';
  if (b.includes('â›”') || b.includes('NO backpacks') || b.includes('WARNING') || b.includes('âš ï¸') || b.includes('verify')) return 'b-warn';
  if (b.includes('âš¡') || b.includes('Optional')) return 'b-opt';
  if (b.includes('ğŸ½ï¸') || b.includes('Restaurant')) return 'b-rest';
  if (b.includes('ğŸš•') || b.includes('Taxi')) return 'b-taxi';
  return 'b-walk';
}

ITIN.forEach(day => {
  const sec = document.createElement('div');
  sec.className = 'day-section';
  sec.innerHTML = `<div class="day-header" style="background:${day.color}">
    <h2>${day.title}</h2><p>${day.subtitle}</p>
    ${day.stats.length?`<div class="day-stats">${day.stats.map(s=>`<span>${s}</span>`).join('')}</div>`:''}
  </div>`;

  day.stops.forEach(s => {
    if (s.tr) {
      const t = document.createElement('div');
      t.className = 'transit';
      const ic = s.tr.startsWith('ğŸš•') ? 'ğŸš•' : s.tr.startsWith('ğŸš¶') ? 'ğŸš¶' : 'â€¢';
      t.innerHTML = `<span>${ic}</span><span>${s.tr.replace(/^[ğŸš•ğŸš¶â€¢]\s*/,'')}</span>`;
      sec.appendChild(t); return;
    }
    const loc = s.loc ? LOCS.find(l => l.id === s.loc) : null;
    const el = document.createElement('div');
    el.className = 'stop';
    const badges = (s.badges||[]).map(b=>`<span class="badge ${badgeCls(b)}">${b}</span>`).join('');
    const acts = loc ? `<div class="stop-acts">
      <button onclick="flyTo('${loc.id}')" class="s-btn" style="background:#FF6B35;color:white">ğŸ—ºï¸ Show on Map</button>
      <a href="${loc.mapsUrl}" target="_blank" class="s-btn" style="background:#4285F4;color:white">Google Maps</a>
      <a href="https://www.google.com/maps/dir/?api=1&destination=${loc.lat},${loc.lng}" target="_blank" class="s-btn" style="background:#0F9D58;color:white">Directions</a>
    </div>` : '';
    el.innerHTML = `
      <div class="stop-time">${s.time}</div>
      <div class="stop-name">${s.icon} ${s.name}</div>
      <div class="stop-desc">${s.desc}</div>
      ${badges?`<div class="stop-badges">${badges}</div>`:''}
      ${acts}`;
    sec.appendChild(el);
  });
  itinEl.appendChild(sec);
});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TICKETS RENDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const tktEl = document.getElementById('tickets');

tktEl.innerHTML = `<div class="card">
  <h3>ğŸ« Your Tickets</h3>
  <p style="font-size:13px;color:var(--muted);line-height:1.5">All tickets are digital â€” show QR codes on your phone screen at entry. Keep brightness high. Have both phones ready for dual bookings.</p>
</div>`;

TICKETS.forEach(t => {
  const div = document.createElement('div');
  div.className = 'tkt-card';

  const refsHtml = t.refs.map(r => `<div><strong>${r.l}:</strong> ${r.v}</div>`).join('');
  const inclHtml = t.includes ? `<div class="tkt-includes">
    <h4>âœ… This ticket includes:</h4>
    ${t.includes.map(i=>`<div class="tkt-inc-item"><span>â€¢</span><span>${i}</span></div>`).join('')}
  </div>` : '';
  const warnHtml = t.warnings.length ? `<div class="tkt-warn">
    <h4>âš ï¸ Important notes:</h4>
    ${t.warnings.map(w=>`<div class="tkt-warn-item"><span>â€¢</span><span>${w}</span></div>`).join('')}
  </div>` : '';
  const alertHtml = t.alert ? `<div class="tkt-alert">${t.alert}</div>` : '';

  div.innerHTML = `
    <div class="tkt-hdr" style="background:${t.color}">
      <div class="tkt-emoji">${t.icon}</div>
      <div class="tkt-hdr-text">
        <h2>${t.name}</h2>
        <p>${t.subtitle}</p>
      </div>
    </div>
    <div class="tkt-body">
      <div class="tkt-time-block">
        <div class="tkt-time">${t.time}</div>
        <div class="tkt-time-label">${t.timeRange}</div>
      </div>
      <div class="tkt-grid">
        <div class="tkt-field"><strong>Who</strong><span>${t.people.join(' + ')}</span></div>
        <div class="tkt-field"><strong>Total paid</strong><span>${t.amount}</span></div>
        <div class="tkt-field"><strong>Order ref</strong><span>${t.order}</span></div>
      </div>
      <div class="tkt-refs">${refsHtml}</div>
      ${inclHtml}
      ${warnHtml}
      ${alertHtml}
      <div class="tkt-acts">
        <a href="${t.mapsUrl}" target="_blank" class="tkt-btn" style="background:#4285F4;color:white">ğŸ—ºï¸ Open in Maps</a>
        <a href="https://www.google.com/maps/dir/?api=1&destination=${t.lat},${t.lng}" target="_blank" class="tkt-btn" style="background:#0F9D58;color:white">ğŸ“ Directions</a>
        <button onclick="flyToTicket('${t.id}')" class="tkt-btn" style="background:#FF6B35;color:white">ğŸ“ Show on Map</button>
      </div>
    </div>`;
  tktEl.appendChild(div);
});

function flyToTicket(id) {
  const locId = id === 'giotto' ? 'campanile' : id === 'uffizi' ? 'uffizi' : 'accademia';
  flyTo(locId);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TIPS RENDER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const tipsEl = document.getElementById('tips');
const TIPS = [
  { icon:'ğŸš•', title:'Getting Around', items:[
    { icon:'ğŸš•', h:'Taxis',           b:'Use official white Florence taxis (metered). itTaxi app or Uber work well. Hotel â†’ Fiesole ~â‚¬20â€“25; â†’ Airport ~â‚¬22â€“25.' },
    { icon:'ğŸšŒ', h:'Bus 13',          b:'Runs from Piazza San Marco to Piazzale Michelangelo. Perfect for the Saturday sunset.' },
    { icon:'ğŸš¶', h:'Walking',          b:'Florence\'s centre is tiny â€” almost everything within 15â€“20 min from Hotel Berchielli.' },
    { icon:'âœˆï¸', h:'Airport taxi',    b:'Aeroporto Amerigo Vespucci (Peretola/FLR) is ~20â€“25 min. Book via itTaxi in advance.' },
  ]},
  { icon:'ğŸ½ï¸', title:'Eating & Drinking', items:[
    { icon:'â˜•', h:'Coffee culture',    b:'Espresso at the bar = authentic and cheaper. Cappuccino = morning only. "Un caffÃ¨" = espresso.' },
    { icon:'ğŸ·', h:'Tipping',          b:'Not expected in Italy. Round up or leave â‚¬1â€“2 per person at restaurants. Never tip at bars.' },
    { icon:'â°', h:'Meal times',       b:'Lunch 13:00â€“14:30. Dinner not before 19:30 (restaurants open then). Earlier = touristy.' },
    { icon:'ğŸ¥©', h:'Must-try dishes',  b:'Bistecca alla Fiorentina, Ribollita, Pappardelle al cinghiale, Lampredotto, Schiacciata.' },
    { icon:'ğŸ¦', h:'Gelato tips',     b:'Real gelato is stored in metal containers with lids. Vivoli, La Carraia, Gelateria dei Neri are the real deal.' },
  ]},
  { icon:'ğŸ›ï¸', title:'Visiting Sights', items:[
    { icon:'ğŸ‘—', h:'Church dress code', b:'Cover shoulders and knees for all churches (Duomo, S.M. Novella, etc). Pack a scarf or light layer.' },
    { icon:'ğŸ’', h:'Saturday: NO bags', b:'Campanile at 11:15 prohibits backpacks. Small bags max 40Ã—30Ã—18cm only. Leave bags at hotel.' },
    { icon:'ğŸŒ…', h:'Best visit times',  b:'Early morning (8â€“9am) beats the crowds. Sights at opening are quiet. Midday is busiest.' },
    { icon:'ğŸ“·', h:'Photography',      b:'No flash in churches. Uffizi allows photography without flash. Brancacci Chapel = no photos.' },
  ]},
  { icon:'ğŸ’¶', title:'Money & Payments', items:[
    { icon:'ğŸ’³', h:'Cards',            b:'Most places accept cards. Carry some cash (â‚¬50â€“100) â€” small bars and street food are often cash-only.' },
    { icon:'ğŸ§¾', h:'Coperto',          b:'Many restaurants charge â‚¬1.50â€“3 per person "cover charge". Normal â€” it covers bread.' },
    { icon:'ğŸ§', h:'ATMs',             b:'Use ATMs from Italian banks (Intesa, UniCredit). Avoid standalone ATMs with extra fees.' },
  ]},
  { icon:'ğŸŒ¤ï¸', title:'February in Florence', items:[
    { icon:'ğŸŒ¡ï¸', h:'Weather',         b:'8â€“14Â°C. Can be chilly and rainy. Dress in layers, bring a waterproof jacket. Fewer tourists = a real advantage!' },
    { icon:'ğŸ‘Ÿ', h:'Footwear',         b:'Comfortable walking shoes â€” cobblestones are everywhere. Break them in before the trip.' },
    { icon:'ğŸŒ‡', h:'Sunset',           b:'Sunset in February is around 17:40â€“17:50. Perfect for Piazzale Michelangelo on Saturday.' },
  ]},
  { icon:'ğŸ—£ï¸', title:'Useful Italian Phrases', phrases:[
    ['Un caffÃ¨ per favore','One coffee please'],['Il conto, per favore','The bill please'],
    ['Grazie / Prego','Thank you / You\'re welcome'],['Dov\'Ã¨...?','Where is...?'],
    ['Buongiorno / Buonasera','Good morning / evening'],['Scusi','Excuse me / Sorry'],
    ['Quanto costa?','How much?'],['Parla inglese?','Do you speak English?'],
    ['Vorrei...','I would like...'],['Per favore','Please'],
  ]},
  { icon:'ğŸ†˜', title:'Emergency & Useful Contacts', items:[
    { icon:'ğŸš¨', h:'Emergency (all)',   b:'112 (European emergency â€” police, ambulance, fire)' },
    { icon:'ğŸ¥', h:'Hospital',          b:'Ospedale Santa Maria Nuova, Piazza S.M. Nuova 1 (~10 min from hotel)' },
    { icon:'ğŸ’Š', h:'Pharmacy',          b:'Look for green cross. Farmacia Centrale (Piazza della Repubblica) open late.' },
    { icon:'ğŸ“', h:'Hotel Berchielli',  b:'+39 055 264061' },
  ]},
];

TIPS.forEach(s => {
  const div = document.createElement('div');
  div.className = 'tips-section';
  if (s.phrases) {
    div.innerHTML = `<h3>${s.icon} ${s.title}</h3><div class="phrase-grid">${s.phrases.map(([it,en])=>`<div class="phrase"><strong>${it}</strong><em>${en}</em></div>`).join('')}</div>`;
  } else {
    div.innerHTML = `<h3>${s.icon} ${s.title}</h3>`+s.items.map(i=>`<div class="tip-row"><div class="tip-icon">${i.icon}</div><div class="tip-body"><strong>${i.h}</strong><span>${i.b}</span></div></div>`).join('');
  }
  tipsEl.appendChild(div);
});
</script>
</body>
</html>
